import pandas as pd

def ads_performance(ads: pd.DataFrame) -> pd.DataFrame:
    return  ads.groupby('ad_id')['action'].apply(lambda x:   round((x == 'Clicked').sum()*100/((x == 'Clicked').sum()+(x == 'Viewed').sum()),2) if ((x == 'Clicked').sum()+(x == 'Viewed').sum())!=0 else 0).rename('ctr').reset_index().sort_values(by=['ctr','ad_id'],ascending=[False, True])


















































































    
    